<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8" /><title>prompt</title><style>textarea { width: 99%; min-height: 150px; resize: vertical; }</style><script type="text/javascript"><!--
var selectElement, messageP, divElement, buttonElement, controls, pElements = [], fileReader = new FileReader(), templates = [ { title: '' }, { title: 'Row Count', format: 'SELECT COUNT(*) FROM {Table}', parameters: ['Table'] }, { title: 'Unique Values', format: 'SELECT {Column}, COUNT(*) FROM {Table} GROUP BY {Column} ORDER BY 2 DESC', parameters: ['Table', 'Column'] },  ]; function init() { selectElement = document.getElementsByTagName('select')[0]; messageP = document.getElementById('messageP'); divElement = document.getElementsByTagName('div')[0]; buttonElement = document.getElementsByTagName('button')[0]; controls = document.forms[0].elements; for (var n = templates.length, i = 0; i < n; ++i) addTemplate(templates[i]); } function loadTemplates(fileInput) { fileReader.onloadend = function () { if (processTemplates(fileReader.result)) { messageP.textContent = 'Templates loaded successfully.'; messageP.style.color = 'green'; } else { messageP.textContent = 'Template file is invalid.'; messageP.style.color = 'red'; } }; fileReader.readAsText(fileInput.files[0]); } function processTemplates(text) { vara, n, i, p, m, j; try { a = JSON.parse(text); } catch (ex) { console.error(ex);return false; } if (!Array.isArray(a)) return false; for (n = a.length, i = 0; i < n; ++i) { p = a[i]; if (!p.hasOwnProperty('title') || typeof p.title != 'string') return false; if (!p.hasOwnProperty('format') || typeof p.format != 'string') return false; if (!p.hasOwnProperty('parameters') || !Array.isArray(p.parameters)) return false; for (m = p.parameters.length, j = 0; j < m; ++j) if (typeofp.parameters[j] != 'string') return false; templates.push(p); addTemplate(p); }return true; } function addTemplate(template) { var p = document.createElement('option'); p.text = template.title; selectElement.add(p); } function selectTemplate() { buttonElement.disabled = true; divElement.innerHTML = ''; if (!selectElement.selectedIndex) return; var p, q, r, m, i, a = templates[selectElement.selectedIndex].parameters, n = a.length; if (!n) { buttonElement.disabled = false; return; } for (m = pElements.length, i = 0; i < n; ++i) { if (m > i) { p = pElements[i]; q = p.firstChild; q.lastChild.value = ''; q.firstChild.textContent = a[i]+ ': '; } else { p = document.createElement('p'); q = document.createElement('label'); q.textContent = a[i] + ': '; r = document.createElement('input'); r.type= 'text'; r.oninput = function (e) { for (var n = templates[selectElement.selectedIndex].parameters.length, i = 0; i < n; ++i) if (!pElements[i].firstChild.lastChild.value.length) { buttonElement.disabled = true; return; } buttonElement.disabled = false; }; q.appendChild(r); p.appendChild(q); pElements.push(p); }; divElement.appendChild(p); } } function generateQuery() { var n, i, p = templates[selectElement.selectedIndex], q = p.format, a = p.parameters; for (n = a.length, i = 0; i < n; ++i) q = q.replace(new RegExp('\{' + a[i] + '\}', 'g'), pElements[i].firstChild.lastChild.value); controls[0].value = q; controls[1].disabled = false; }
//-->
</script></head><body onload="init()"><p>Query Templates: <select oninput="selectTemplate()"></select></p><p>Load query templates from file: <input type="file"oninput="loadTemplates(this)" /></p><p id="messageP"></p><fieldset><legend>Template Parameters</legend><div></div><button onclick="generateQuery()" disabled>Generate Query</button></fieldset><form><p>Query:<br /><textarea name="query" oninput="controls[1].disabled=!controls[0].value.length"></textarea></p><p><input type="submit" disabled /></p></form></body></html>